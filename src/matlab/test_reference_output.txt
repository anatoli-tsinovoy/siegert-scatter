================================================================
SPS TEST SUITE - Reference outputs for Python implementation
================================================================
 
=== TEST 1: Jacobi Polynomials ===
 
Test 1.1: j_polynomial(5, 5, 0, 4, [-1,-0.5,0,0.5,1])
Shape: [5 x 6]
Values:
 Columns 1 through 3:

   1.000000000000000e+00  -5.000000000000000e+00   1.500000000000000e+01
   1.000000000000000e+00  -3.500000000000000e+00   6.250000000000000e+00
   1.000000000000000e+00  -2.000000000000000e+00   1.000000000000000e+00
   1.000000000000000e+00  -5.000000000000000e-01  -7.500000000000000e-01
   1.000000000000000e+00   1.000000000000000e+00   1.000000000000000e+00

 Columns 4 through 6:

  -3.500000000000000e+01   7.000000000000000e+01  -1.260000000000000e+02
  -6.875000000000000e+00   4.058593750000000e+00   8.183593750000000e-01
   1.000000000000000e+00  -1.062500000000000e+00  -6.250000000000000e-01
  -1.250000000000000e-01   4.960937500000000e-01   5.097656250000000e-01
   1.000000000000000e+00   1.000000000000000e+00   1.000000000000000e+00
Test 1.2: j_polynomial for l=0 case (alpha=0, beta=0)
x values:
 Columns 1 through 3:

  -9.000000000000000e-01  -4.250000000000000e-01   4.999999999999999e-02

 Columns 4 and 5:

   5.250000000000000e-01   1.000000000000000e+00
JP(x):
 Columns 1 through 3:

   1.000000000000000e+00  -9.000000000000000e-01   7.150000000000001e-01
   1.000000000000000e+00  -4.250000000000000e-01  -2.290624999999999e-01
   1.000000000000000e+00   4.999999999999999e-02  -4.962500000000000e-01
   1.000000000000000e+00   5.250000000000000e-01  -8.656249999999993e-02
   1.000000000000000e+00   1.000000000000000e+00   1.000000000000000e+00

 Column 4:

  -4.725000000000001e-01
   4.455859375000000e-01
  -7.468749999999998e-02
  -4.257421875000000e-01
   1.000000000000000e+00
 
=== TEST 2: Gaussian Quadrature ===
 
Test 2.1: Gauss-Jacobi quadrature N=5, alpha=0, beta=0
Nodes (x_i):
 Columns 1 through 3:

  -9.061798459386641e-01  -5.384693101056830e-01  -1.081853856991421e-16

 Columns 4 and 5:

   5.384693101056831e-01   9.061798459386639e-01
Weights (omega_i):
 Columns 1 through 3:

   2.369268850561892e-01   4.786286704993669e-01   5.688888888888890e-01

 Columns 4 and 5:

   4.786286704993672e-01   2.369268850561891e-01
Test 2.2: Gauss-Jacobi quadrature N=5, alpha=0, beta=4
Nodes (x_i):
 Columns 1 through 3:

  -5.204159103950379e-01  -7.813265093696906e-02   3.601184654820191e-01

 Columns 4 and 5:

   7.217726873528852e-01   9.452288370685309e-01
Weights (omega_i):
 Columns 1 through 3:

   2.230326649360297e-02   3.267373352151109e-01   1.408783024172255e+00

 Columns 4 and 5:

   2.646806819262074e+00   1.995369554856965e+00
Test 2.3: Gauss-Jacobi quadrature N=20, alpha=0, beta=0
First 5 nodes (x_i):
 Columns 1 through 3:

  -9.931285991850950e-01  -9.639719272779136e-01  -9.122344282513257e-01

 Columns 4 and 5:

  -8.391169718222189e-01  -7.463319064601508e-01
Last 5 nodes (x_i):
 Columns 1 through 3:

   7.463319064601509e-01   8.391169718222189e-01   9.122344282513254e-01

 Columns 4 and 5:

   9.639719272779137e-01   9.931285991850947e-01
First 5 weights (omega_i):
 Columns 1 through 3:

   1.761400713915209e-02   4.060142980038740e-02   6.267204833410854e-02

 Columns 4 and 5:

   8.327674157670478e-02   1.019301198172402e-01
 
=== TEST 3: Spherical Bessel Zeros ===
 
Test 3.1: calc_z_l(0, false)
Number of zeros: 0
  (empty for l=0)
Test 3.2: calc_z_l(1, false)
Number of zeros: 1
Values:
  z_1_1 = -1.000000000000000e+00 + 0.000000000000000e+00i
Test 3.3: calc_z_l(2, false)
Number of zeros: 2
Values:
  z_2_1 = -1.500000000000000e+00 + -8.660254037844386e-01i
  z_2_2 = -1.500000000000000e+00 + 8.660254037844386e-01i
Test 3.4: calc_z_l(3, false)
Number of zeros: 3
Values:
  z_3_1 = -2.322185354626086e+00 + 0.000000000000000e+00i
  z_3_2 = -1.838907322686957e+00 + -1.754380959783722e+00i
  z_3_3 = -1.838907322686957e+00 + 1.754380959783722e+00i
Test 3.5: calc_z_l(4, false)
Number of zeros: 4
Values:
  z_4_1 = -2.103789397179628e+00 + -2.657418041856753e+00i
  z_4_2 = -2.103789397179628e+00 + 2.657418041856753e+00i
  z_4_3 = -2.896210602820372e+00 + -8.672341289345038e-01i
  z_4_4 = -2.896210602820372e+00 + 8.672341289345038e-01i
Test 3.6: calc_z_l(5, false)
Number of zeros: 5
Values:
  z_5_1 = -3.646738595329643e+00 + 0.000000000000000e+00i
  z_5_2 = -3.351956399153533e+00 + -1.742661416183198e+00i
  z_5_3 = -3.351956399153533e+00 + 1.742661416183198e+00i
  z_5_4 = -2.324674303181645e+00 + -3.571022920337976e+00i
  z_5_5 = -2.324674303181645e+00 + 3.571022920337976e+00i
 
=== TEST 4: Median Filter ===
 
Test 4.1: medfilt1([1,5,2,8,3,7,4,6,9,0], 3)
Input:
 Columns 1 through 3:

   1.000000000000000e+00   5.000000000000000e+00   2.000000000000000e+00

 Columns 4 through 6:

   8.000000000000000e+00   3.000000000000000e+00   7.000000000000000e+00

 Columns 7 through 9:

   4.000000000000000e+00   6.000000000000000e+00   9.000000000000000e+00

 Column 10:

                       0
Output (window=3):
 Columns 1 through 3:

   3.000000000000000e+00   2.000000000000000e+00   5.000000000000000e+00

 Columns 4 through 6:

   3.000000000000000e+00   7.000000000000000e+00   4.000000000000000e+00

 Columns 7 through 9:

   6.000000000000000e+00   6.000000000000000e+00   6.000000000000000e+00

 Column 10:

   4.500000000000000e+00
Test 4.2: medfilt1(..., 5)
Output (window=5):
 Columns 1 through 3:

   2.000000000000000e+00   3.500000000000000e+00   3.000000000000000e+00

 Columns 4 through 6:

   5.000000000000000e+00   4.000000000000000e+00   6.000000000000000e+00

 Columns 7 through 9:

   6.000000000000000e+00   6.000000000000000e+00   5.000000000000000e+00

 Column 10:

   6.000000000000000e+00
 
=== TEST 5: TISE Eigenvalue Solver ===
 
Test 5.1: TISE_by_SPS with N=10, a=10, l=0
Number of eigenvalues k_n: 20
First 10 k_n values (sorted by real part):
  k_1 = -2.3170845015e+00 + -1.1423039872e+00i
  k_2 = -1.4457611818e+00 + -6.8535925734e-01i
  k_3 = -1.4037401045e+00 + -4.8712286664e-01i
  k_4 = -9.1265562010e-01 + -8.1446017551e-01i
  k_5 = -8.8951902847e-01 + -9.8891265281e-01i
  k_6 = -5.3225789764e-01 + -1.0068136715e+00i
  k_7 = -3.0026150155e-01 + -1.0408245795e+00i
  k_8 = -2.7424115096e-01 + -1.2441800268e+00i
  k_9 = 0.0000000000e+00 + -8.2421970817e+00i
  k_10 = 0.0000000000e+00 + 2.9975415712e+00i
Number of bound states: 2
Bound state k values:
  k_bound_1 = 2.9975415712e+00i (E = -4.4926277356e+00)
  k_bound_2 = 7.7638177480e-01i (E = -3.0138433012e-01)
 
Test 5.2: TISE_by_SPS with N=10, a=10, l=1
First 10 k_n values:
  k_1 = -1.7760673591e+00 + -1.9013012332e-01i
  k_2 = -1.6972758895e+00 + -5.2217765026e-01i
  k_3 = -1.2718833223e+00 + -6.4267811191e-01i
  k_4 = -1.1489852395e+00 + -8.5775672349e-01i
  k_5 = -8.1891929105e-01 + -9.1382894459e-01i
  k_6 = -7.5982042284e-01 + -1.1449109333e+00i
  k_7 = -4.3147328648e-01 + -9.7074249482e-01i
  k_8 = -4.1502541216e-01 + -3.2080456218e-01i
  k_9 = -3.2291054414e-01 + -1.4796567593e+00i
  k_10 = 0.0000000000e+00 + -3.4060869155e+00i
 
Test 5.3: TISE_by_SPS with N=30, a=10, l=0
Number of bound states: 2
Bound state energies:
  E_1 = -4.5000000722e+00
  E_2 = -5.0000019054e-01
Quadrature points r_i (first 5):
 Columns 1 through 3:

   1.553257962675192e-02   8.165938360126357e-02   1.998906751584634e-01

 Columns 4 and 5:

   3.689997628536273e-01   5.871973210397358e-01
 
=== TEST 6: Cross Section Calculation ===
 
Test 6.1: calc_cross_section_by_SPS, N=20, a=10, l_max=3
Energy grid: 50 points from 0.0001 to 5
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
 
--- Scattering length ---
alpha (l=0): 2.0851378017e+00
 
--- k_n values for each l ---
l=0: 40 eigenvalues
  Resonances (Re(k)>0, |Im(k)|<0.5): 1
    k = 3.8823509342e+00 + -3.4800920015e-01i
l=1: 41 eigenvalues
  Resonances (Re(k)>0, |Im(k)|<0.5): 2
    k = 4.0337353293e-01 + -2.4676798130e-01i
    k = 3.9102894414e+00 + -4.3267823536e-01i
l=2: 42 eigenvalues
  Resonances (Re(k)>0, |Im(k)|<0.5): 1
    k = 4.4932222529e-01 + -1.7819020463e-02i
l=3: 43 eigenvalues
  Resonances (Re(k)>0, |Im(k)|<0.5): 1
    k = 1.4385350242e+00 + -4.9154996351e-01i
 
--- S-matrix at selected energies ---
E = 1.0000e-04
  S_0 = 9.9826151551e-01 + -5.8940195610e-02i  (|S|=1.0000000000e+00)
  S_1 = 9.9999999927e-01 + 3.8250718107e-05i  (|S|=1.0000000000e+00)
  S_2 = 1.0000000000e+00 + 7.4579402755e-09i  (|S|=1.0000000000e+00)
  S_3 = 1.0000000000e+00 + 1.3862628260e-13i  (|S|=1.0000000000e+00)
E = 9.1845e-01
  S_0 = -1.4567716324e-01 + 9.8933218087e-01i  (|S|=1.0000000000e+00)
  S_1 = 6.9802092973e-01 + 7.1607735731e-01i  (|S|=1.0000000000e+00)
  S_2 = 5.1212951845e-01 + -8.5890823511e-01i  (|S|=1.0000000000e+00)
  S_3 = 4.5559131442e-01 + 8.9018905533e-01i  (|S|=1.0000000000e+00)
E = 2.4490e+00
  S_0 = 9.9945367353e-01 + 3.3050786255e-02i  (|S|=1.0000000000e+00)
  S_1 = 8.7953508174e-01 + -4.7583404670e-01i  (|S|=1.0000000000e+00)
  S_2 = -1.5088772436e-02 + -9.9988615799e-01i  (|S|=1.0000000000e+00)
  S_3 = -9.8467489551e-01 + 1.7439997179e-01i  (|S|=1.0000000000e+00)
E = 5.0000e+00
  S_0 = 3.1096611235e-01 + -9.5042099986e-01i  (|S|=1.0000000000e+00)
  S_1 = 1.8599287780e-02 + -9.9982701829e-01i  (|S|=1.0000000000e+00)
  S_2 = -5.8595509784e-01 + -8.1034352180e-01i  (|S|=1.0000000000e+00)
  S_3 = -9.9987681169e-01 + -1.5695905620e-02i  (|S|=1.0000000000e+00)
 
--- Cross sections at selected energies ---
E = 1.0000e-04
  sigma_0 = 5.4616101130e+01
  sigma_1 = 6.8947784834e-05
  sigma_2 = 4.3684531621e-12
  sigma_3 = 2.1130953762e-21
  sigma_total = 5.4616170078e+01
E = 9.1845e-01
  sigma_0 = 3.9188360371e+00
  sigma_1 = 3.0987956319e+00
  sigma_2 = 8.3439056213e+00
  sigma_3 = 1.3035206698e+01
  sigma_total = 2.8396743988e+01
E = 2.4490e+00
  sigma_0 = 7.0082228595e-04
  sigma_1 = 4.6359367704e-01
  sigma_2 = 6.5107300298e+00
  sigma_3 = 1.7821451591e+01
  sigma_total = 2.4796476120e+01
E = 5.0000e+00
  sigma_0 = 4.3293275990e-01
  sigma_1 = 1.8498967606e+00
  sigma_2 = 4.9824248843e+00
  sigma_3 = 8.7959176195e+00
  sigma_total = 1.6061172024e+01
 
--- Time delays at selected energies ---
E = 1.0000e-04
  tau_0 = -1.4742479722e+02
  tau_1 = 2.8691584011e-01
  tau_2 = 9.3242188042e-05
  tau_3 = 2.4336747128e-09
E = 9.1845e-01
  tau_0 = -8.8298530695e-01
  tau_1 = -6.1885892777e-01
  tau_2 = -2.2582826470e-01
  tau_3 = 1.1862183544e+00
E = 2.4490e+00
  tau_0 = -3.6225093423e-01
  tau_1 = -2.9447932918e-01
  tau_2 = -1.5043374644e-01
  tau_3 = 1.6515462289e-01
E = 5.0000e+00
  tau_0 = -2.0929801280e-01
  tau_1 = -1.6018856217e-01
  tau_2 = -9.8181839776e-02
  tau_3 = -1.3637255509e-02
 
=== TEST 7: Full SPS Calculation ===
 
Parameters: N=50, a=10, l_max=5
Energy grid: 1000 points
 
Computing potential 1...
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
l = 4.000000000000000e+00
l = 5.000000000000000e+00
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
l = 4.000000000000000e+00
l = 5.000000000000000e+00
Computing potential 2...
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
l = 4.000000000000000e+00
l = 5.000000000000000e+00
l =                     0
l = 1.000000000000000e+00
l = 2.000000000000000e+00
l = 3.000000000000000e+00
l = 4.000000000000000e+00
l = 5.000000000000000e+00
 
--- Results ---
Scattering length (alpha_1): 2.0833387754e+00
Scattering length (alpha_2): 2.0833404517e+00
Mean tau_1 at E=E_vec(1): -1.4731413093e+03
Mean tau_2 at E=E_vec(1): -1.4731424946e+03
Rate coefficient Gamma_12: 8.0402772546e-05 cm^3/sec
 
--- S-matrix values at specific energies ---
E = 1.000000e-06
  S_0(pot1) = 9.9998263886e-01 + -5.8925355802e-03i
  S_0(pot2) = 9.9998263883e-01 + -5.8925403215e-03i
E = 9.909919e-01
  S_0(pot1) = -2.4954117252e-02 + 9.9968859753e-01i
  S_0(pot2) = -2.4953018663e-02 + 9.9968862495e-01i
E = 4.994995e+00
  S_0(pot1) = 3.4438504279e-01 + -9.3882849462e-01i
  S_0(pot2) = 3.4438434727e-01 + -9.3882874975e-01i
E = 1.000000e+01
  S_0(pot1) = -7.1045420399e-01 + -7.0374343623e-01i
  S_0(pot2) = -7.1045461647e-01 + -7.0374301982e-01i
 
--- Cross sections at specific energies ---
E = 1.000000e-06
  sigma_total(pot1) = 5.4541625135e+01
  sigma_total(pot2) = 5.4541712906e+01
E = 9.909919e-01
  sigma_total(pot1) = 3.0153498143e+01
  sigma_total(pot2) = 3.0153474058e+01
E = 4.994995e+00
  sigma_total(pot1) = 2.8859242790e+01
  sigma_total(pot2) = 2.8859239665e+01
E = 1.000000e+01
  sigma_total(pot1) = 1.8489697334e+01
  sigma_total(pot2) = 1.8489694913e+01
 
=== TEST 8: Numerical Consistency ===
 
Test 8.1: S-matrix unitarity |S_l|^2 = 1
  max(|S_0|^2 - 1) for pot1 = 7.1054273576e-15
  mean(|S_0|^2) for pot1 = 1.0000000000e+00
 
Test 8.2: Bound state energies from k_n_l
  l=0 bound states:
    E_1 = -4.5000002013e+00
    E_2 = -5.0000010163e-01
  l=1 bound states:
    E_1 = -1.7295408802e+00
  l=2: no bound states found
 
=== SUMMARY (JSON-like format) ===
{
  "test_jacobi_polynomial": {
    "alpha": 0,
    "beta": 4,
    "x": [-1, -0.5, 0, 0.5, 1],
    "P_0": [1, 1, 1, 1, 1],
    "P_1": [-5.0000000000e+00, -3.5000000000e+00, -2.0000000000e+00, -5.0000000000e-01, 1.0000000000e+00]
  },
  "test_quadrature_N5_l0": {
    "nodes": [-9.061798459386641e-01, -5.384693101056830e-01, -1.081853856991421e-16, 5.384693101056831e-01, 9.061798459386639e-01],
    "weights": [2.369268850561892e-01, 4.786286704993669e-01, 5.688888888888890e-01, 4.786286704993672e-01, 2.369268850561891e-01]
  },
  "test_scattering_length": {
    "alpha_1": 2.083338775355517e+00,
    "alpha_2": 2.083340451677850e+00
  },
  "test_rate_coefficient": {
    "kbT_natural": 5,
    "Gamma_12_cm3_per_sec": 8.040277254630431e-05
  }
}
 
================================================================
TEST SUITE COMPLETE
================================================================

